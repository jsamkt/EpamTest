The general idea of the solution in run through data once calculating dates based on the algorithm like state machine  
The complexity of algorithm is O(n).

I used Flux from Reactor project in order to separate the data publishing and calculation logic.
